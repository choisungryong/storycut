<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klippa - AI Video Creation Studio</title>
    <meta name="robots" content="noindex">
    <link rel="stylesheet" href="/static/css/design-tokens.css">
    <link rel="stylesheet" href="/static/css/shared.css">
    <link rel="stylesheet" href="/static/css/app.css?v=20260218_0100">
    <script src="/static/auth.js"></script>
</head>

<body class="app-body">
    <!-- Ambient background glow -->
    <div class="app-bg-glow"></div>

    <!-- ═══ FIXED NAVIGATION ═══ -->
    <nav class="sc-nav app-nav" id="appNav">
        <div class="sc-nav__inner">
            <a href="/" class="sc-nav__logo">
                <img src="/static/assets/klippa-logo.png" alt="Klippa" class="sc-nav__logo-img">
            </a>
            <div class="app-nav__tabs">
                <a href="#" id="nav-create" class="app-nav__tab active nav-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2"/><path d="M7 2v20M17 2v20M2 12h20"/></svg>
                    <span data-i18n="nav.create">새 영상</span>
                </a>
                <a href="#" id="nav-mv" class="app-nav__tab nav-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    <span data-i18n="nav.mv">뮤직비디오</span>
                </a>
                <a href="#" id="nav-history" class="app-nav__tab nav-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
                    <span data-i18n="nav.history">내 영상</span>
                </a>
            </div>
            <div class="app-nav__right">
                <a href="/pricing.html" class="app-nav__link" data-i18n="nav.pricing">요금제</a>
            </div>
        </div>
    </nav>

    <!-- ═══ MAIN CONTENT ═══ -->
    <main class="app-main">

        <!-- ══════════════════════════════════════
             INPUT SECTION
             ══════════════════════════════════════ -->
        <div id="input-section" class="section">
            <div class="app-form-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="input.label">만들기</span>
                    <h2 class="section-title" data-i18n="input.title">새 영상</h2>
                    <p class="section-subtitle" data-i18n="input.subtitle">주제를 입력하면 AI가 내레이션, 이미지, 효과가 포함된 완성 영상을 자동 생성합니다.</p>
                </div>

                <form id="generate-form" class="app-form">
                    <!-- Mode Toggle -->
                    <div class="app-card">
                        <div class="form-group">
                            <div id="mode-toggle" class="mode-toggle">
                                <button type="button" id="mode-ai-story" class="mode-toggle-btn active" data-i18n="input.mode_ai">
                                    AI Story
                                </button>
                                <button type="button" id="mode-direct-script" class="mode-toggle-btn" data-i18n="input.mode_script">
                                    Direct Script
                                </button>
                            </div>
                        </div>

                        <!-- AI Story: Topic -->
                        <div id="ai-story-inputs" class="form-group">
                            <label for="topic" data-i18n="input.topic_label">주제 / 아이디어</label>
                            <input type="text" id="topic" name="topic"
                                data-i18n-placeholder="input.topic_placeholder"
                                placeholder="예: 오래된 폐병원에서 발견된 수상한 일기장"
                                class="form-input" />
                            <small class="helper-text" data-i18n="input.topic_hint">비워두면 AI가 자동으로 주제를 생성합니다</small>
                            <label class="toggle-item" style="margin-top:10px">
                                <input type="checkbox" name="include_dialogue" id="include_dialogue">
                                <span class="toggle-switch"></span>
                                <span class="toggle-label">
                                    <span>대화 포함</span>
                                    <small>캐릭터 간 대화가 포함된 시나리오 (남/여 화자 분리)</small>
                                </span>
                            </label>
                        </div>

                        <!-- Direct Script -->
                        <div id="direct-script-inputs" class="form-group" style="display:none">
                            <label for="direct-script" data-i18n="input.script_label">나레이션 스크립트</label>
                            <textarea id="direct-script" rows="10"
                                data-i18n-placeholder="input.script_placeholder"
                                placeholder="나레이션 스크립트를 여기에 붙여넣으세요.&#10;&#10;빈 줄로 씬을 구분합니다.&#10;&#10;예시:&#10;망해가는 가게들 사이 번창하는 사업.&#10;비즈니스 연구소에 오신 것을 환영합니다.&#10;&#10;지난번 소개한 가게가&#10;엄청난 반응을 얻었습니다."
                                class="form-input form-textarea"></textarea>
                            <small class="helper-text" data-i18n="input.script_hint">빈 줄로 씬을 구분하세요. AI가 각 씬에 맞는 이미지를 생성합니다.</small>
                        </div>
                    </div>

                    <!-- Style & Genre -->
                    <div class="app-card">
                        <div class="app-card-label" data-i18n="input.style_genre">스타일 & 장르</div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label for="genre" data-i18n="input.genre">장르</label>
                                <div class="select-wrapper">
                                    <select id="genre" name="genre" class="form-select">
                                        <option value="emotional">감성</option>
                                        <option value="mystery" selected>미스터리</option>
                                        <option value="thriller">스릴러</option>
                                        <option value="fantasy">판타지</option>
                                        <option value="horror">호러</option>
                                        <option value="comedy">코미디</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="mood" data-i18n="input.mood">분위기</label>
                                <div class="select-wrapper">
                                    <select id="mood" name="mood" class="form-select">
                                        <option value="dramatic" selected>드라마틱</option>
                                        <option value="melancholic">멜랑콜리</option>
                                        <option value="suspenseful">긴장감</option>
                                        <option value="heartwarming">따뜻한</option>
                                        <option value="dark">어두운</option>
                                        <option value="cheerful">밝은</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label for="style" data-i18n="input.style">비주얼 스타일</label>
                                <div class="select-wrapper">
                                    <select id="style" name="style" class="form-select">
                                        <option value="cinematic, high contrast" selected>시네마틱</option>
                                        <option value="realistic">리얼리스틱</option>
                                        <option value="illustration">일러스트</option>
                                        <option value="anime">애니메</option>
                                        <option value="webtoon">웹툰</option>
                                        <option value="game_anime">게임 애니메</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="character_ethnicity" data-i18n="input.ethnicity">캐릭터 인종</label>
                                <div class="select-wrapper">
                                    <select id="character_ethnicity" name="character_ethnicity" class="form-select">
                                        <option value="auto" selected>AI 자동</option>
                                        <option value="korean">한국인</option>
                                        <option value="japanese">일본인</option>
                                        <option value="chinese">중국인</option>
                                        <option value="southeast_asian">동남아시아인</option>
                                        <option value="european">유럽인</option>
                                        <option value="black">흑인</option>
                                        <option value="hispanic">히스패닉</option>
                                        <option value="mixed">혼혈</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Hidden default voice (used as fallback) -->
                    <input type="hidden" id="voice" name="voice" value="uyVNoMrnUku1dZyVEXwD">

                    <!-- Duration & Platform (버튼 위에 배치) -->
                    <div class="app-card">
                        <div class="form-group">
                            <label for="duration">영상 길이: <span id="duration-display">30</span>초</label>
                            <input type="range" id="duration" name="duration" min="30" max="180" value="30" step="10"
                                class="form-slider" />
                            <div class="slider-labels">
                                <span>30초</span><span>1분</span><span>2분</span><span>3분</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label data-i18n="input.platform">플랫폼</label>
                            <div class="radio-group">
                                <label class="radio-card">
                                    <input type="radio" name="platform" value="youtube_long" checked>
                                    <span class="radio-card__inner">
                                        <span class="radio-card__icon">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8M12 17v4"/></svg>
                                        </span>
                                        <span class="radio-card__label">유튜브 롱폼 (16:9)</span>
                                    </span>
                                </label>
                                <label class="radio-card">
                                    <input type="radio" name="platform" value="youtube_shorts">
                                    <span class="radio-card__inner">
                                        <span class="radio-card__icon">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2"/><path d="M12 18h.01"/></svg>
                                        </span>
                                        <span class="radio-card__label">유튜브 쇼츠 (9:16)</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ★ Submit button - prominent CTA -->
                    <button type="submit" class="btn-cta-generate" id="generate-story-btn">
                        <span class="btn-cta-generate__icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                        </span>
                        <span class="btn-cta-generate__text">
                            <strong data-i18n="input.generate">AI 시나리오 생성</strong>
                            <small>화자 분리 + 음성 선택 단계로 이동</small>
                        </span>
                        <span class="btn-cta-generate__arrow">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                        </span>
                    </button>

                </form>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             STORY REVIEW SECTION
             ══════════════════════════════════════ -->
        <div id="review-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="review.label">2단계</span>
                    <h2 class="section-title" data-i18n="review.title">스토리 검토</h2>
                    <p class="section-subtitle" data-i18n="review.subtitle">
                        AI가 생성한 스토리를 검토하세요. 내레이션이나 비주얼 설명을 자유롭게 편집한 뒤 이미지 생성으로 진행하세요.
                    </p>
                </div>

                <div class="review-container">
                    <div class="story-meta-edit">
                        <label>제목</label>
                        <input type="text" id="review-title" class="form-input input-title" />
                    </div>

                    <!-- Speaker detection summary + voice assignment (injected by JS) -->
                    <div id="voice-selection-slot"></div>

                    <div id="review-scene-grid" class="review-scene-grid"></div>

                    <!-- 이미지 생성 옵션 (리뷰 단계에서 설정) -->
                    <details class="app-card app-accordion" open>
                        <summary class="app-accordion__trigger">
                            <span class="app-card-label">영상 생성 옵션</span>
                            <svg class="app-accordion__arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </summary>
                        <div class="app-accordion__content">
                            <div class="form-group">
                                <label for="image_model">이미지 모델</label>
                                <div class="select-wrapper">
                                    <select id="image_model" name="image_model" class="form-select">
                                        <option value="standard" selected>스탠다드 (Gemini 2.5 Flash) - 빠르고 안정적</option>
                                        <option value="premium">프리미엄 (Gemini 3.0 Pro) - 고품질</option>
                                    </select>
                                    <small id="image_model_hint" class="form-hint" style="color: #888; font-size: 12px; margin-top: 4px; display: none;"></small>
                                </div>
                            </div>

                            <div class="toggle-grid">
                                <label class="toggle-item">
                                    <input type="checkbox" id="ffmpeg_kenburns" checked>
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>Ken Burns 효과</span>
                                        <small>이미지에 줌 & 패닝 효과</small>
                                    </span>
                                </label>
                                <label class="toggle-item">
                                    <input type="checkbox" id="ffmpeg_audio_ducking">
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>오디오 덕킹</span>
                                        <small>나레이션 시 BGM 자동 줄임</small>
                                    </span>
                                </label>
                                <label class="toggle-item">
                                    <input type="checkbox" id="subtitle_burn_in" checked>
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>자막</span>
                                        <small>영상에 자막 삽입</small>
                                    </span>
                                </label>
                                <label class="toggle-item">
                                    <input type="checkbox" id="context_carry_over" checked>
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>맥락 연결</span>
                                        <small>씬 간 시각적 일관성 유지</small>
                                    </span>
                                </label>
                                <label class="toggle-item">
                                    <input type="checkbox" id="optimization_pack">
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>최적화 팩</span>
                                        <small>제목, 썸네일, 해시태그 자동 생성</small>
                                    </span>
                                </label>
                                <label class="toggle-item">
                                    <input type="checkbox" id="film_look">
                                    <span class="toggle-switch"></span>
                                    <span class="toggle-label">
                                        <span>필름 룩</span>
                                        <small>필름 그레인 + 색보정 효과</small>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </details>

                    <div class="review-actions">
                        <button id="back-to-input-btn" class="btn btn-secondary" data-i18n="review.back">
                            설정으로 돌아가기
                        </button>
                        <button id="generate-images-btn" class="btn btn-primary btn-large" data-i18n="review.gen_images">
                            이미지 생성 (2단계)
                        </button>
                        <button id="start-video-generation-btn" class="btn btn-secondary btn-large" data-i18n="review.skip_video">
                            영상으로 건너뛰기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             CHARACTER CASTING SECTION
             ══════════════════════════════════════ -->
        <div id="character-casting-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label">2-A단계</span>
                    <h2 class="section-title">캐릭터 캐스팅</h2>
                    <p class="section-subtitle">
                        각 캐릭터의 앵커 이미지를 확인하세요. 마음에 들지 않으면 재생성할 수 있습니다.
                    </p>
                </div>

                <!-- Casting progress -->
                <div id="casting-progress-container" class="progress-container">
                    <div class="progress-header">
                        <span class="progress-label" id="casting-progress-label">캐릭터 캐스팅 중...</span>
                        <span class="progress-percent" id="casting-progress-percent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="casting-progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Character card grid -->
                <div id="casting-grid" class="image-preview-grid"></div>

                <!-- Action buttons -->
                <div class="section-actions" id="casting-actions" style="display:none;">
                    <button class="btn btn-outline" onclick="app.showSection('review')">
                        스토리 편집으로 돌아가기
                    </button>
                    <button id="approve-casting-btn" class="btn btn-primary btn-large" onclick="app.startImageGenerationAfterCasting()">
                        ✅ 승인 & 이미지 생성
                    </button>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             IMAGE PREVIEW SECTION
             ══════════════════════════════════════ -->
        <div id="image-preview-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="image.label">3단계</span>
                    <h2 class="section-title" data-i18n="image.title">이미지 검토</h2>
                    <p class="section-subtitle" data-i18n="image.subtitle">
                        각 씬의 이미지를 검토하세요. 재생성하거나 I2V 영상으로 변환할 수 있습니다.
                    </p>
                </div>

                <!-- Image generation progress -->
                <div id="image-progress-container" class="progress-container hidden">
                    <div class="progress-header">
                        <span class="progress-label" id="image-progress-label">이미지 생성 중...</span>
                        <span class="progress-percentage" id="image-progress-percentage">0%</span>
                    </div>
                    <div class="progress-bar-wrapper">
                        <div class="progress-bar" id="image-progress-bar"></div>
                    </div>
                    <div class="status-message" id="image-status-message">준비 중...</div>
                </div>

                <div id="image-preview-grid" class="image-preview-grid"></div>
                <div id="image-test-result" class="image-test-result"></div>

                <div class="review-actions">
                    <button id="back-to-review-btn" class="btn btn-secondary" data-i18n="image.edit_story">
                        스토리 편집
                    </button>
                    <!-- Test Image 버튼 제거 (API 엔드포인트 미구현) -->
                    <button id="test-image-btn" class="btn btn-secondary" onclick="app.testImageGeneration()" data-i18n="image.test" style="display:none">
                        테스트 이미지
                    </button>
                    <button id="approve-images-btn" class="btn btn-primary btn-large" disabled data-i18n="image.approve">
                        승인 & 영상 생성 (3단계)
                    </button>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             PROGRESS SECTION
             ══════════════════════════════════════ -->
        <div id="progress-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <h2 class="section-title" id="progress-title">생성 중...</h2>
                </div>

                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-label">전체 진행률</span>
                        <span class="progress-percentage" id="progress-percentage">0%</span>
                    </div>
                    <div class="progress-bar-wrapper">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div class="status-message" id="status-message">초기화 중...</div>

                    <div class="steps-container" id="steps-container">
                        <div class="step" data-step="story">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">스토리 생성</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                        <div class="step" data-step="scenes">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">씬 처리</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                        <div class="step" data-step="compose">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">영상 합성</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                        <div class="step" data-step="optimize">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">최적화</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                    </div>

                    <div class="preview-container hidden" id="preview-container">
                        <div class="visual-preview hidden" id="visual-preview">
                            <h3>스토리보드</h3>
                            <div class="scene-grid" id="scene-grid"></div>
                        </div>
                    </div>

                    <div class="log-container">
                        <div class="log-header">
                            <span>실시간 로그</span>
                            <button id="clear-log-btn" class="btn-small">지우기</button>
                        </div>
                        <div class="log-content" id="log-content"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             RESULT SECTION
             ══════════════════════════════════════ -->
        <div id="result-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="result.label">완료</span>
                    <h2 class="section-title" id="result-header-text" data-i18n="result.title">영상 완성!</h2>
                </div>

                <div class="result-container">
                    <div class="result-info">
                        <p><strong>프로젝트 ID:</strong> <code id="result-project-id"></code></p>
                        <p><strong>제목:</strong> <span id="result-title"></span></p>
                    </div>

                    <div id="shorts-hook-area" class="shorts-hook-area" style="display:none">
                        <label>상단 문구 (Hook Text)</label>
                        <div class="shorts-hook-display">
                            <span id="shorts-hook-text"></span>
                            <button id="shorts-hook-edit-btn" class="btn-icon-small" title="편집">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                            </button>
                        </div>
                    </div>

                    <div class="video-player" id="result-video-container">
                        <video id="result-video" controls></video>
                    </div>

                    <div class="result-actions">
                        <a id="download-btn" class="btn btn-primary" download data-i18n="result.download">
                            영상 다운로드
                        </a>
                        <button id="youtube-upload-btn" class="btn btn-secondary btn-disabled" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0C.488 3.45.029 5.804 0 12c.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 4-8 4z"/></svg>
                            유튜브 업로드 <span class="badge-coming-soon">준비중</span>
                        </button>
                        <button id="new-video-btn" class="btn btn-secondary" data-i18n="result.new_video">
                            새 영상
                        </button>
                    </div>

                    <div id="scene-management" class="scene-management">
                        <h3 data-i18n="result.scene_mgmt">씬 관리</h3>
                        <p class="section-description" data-i18n="result.scene_desc">
                            개별 씬을 검토하고 필요한 것을 재생성하세요. 변경 후 "영상 재합성"을 클릭하면 최종 영상이 업데이트됩니다.
                        </p>
                        <div id="result-scene-grid" class="result-scene-grid"></div>
                        <div class="recompose-actions">
                            <button id="recompose-btn" class="btn btn-primary" style="display:none" data-i18n="result.recompose">
                                영상 재합성
                            </button>
                        </div>
                    </div>

                    <div id="optimization-pack" class="optimization-pack">
                        <h3>YouTube 최적화 패키지</h3>
                        <div class="opt-section">
                            <h4>제목 후보</h4>
                            <div id="title-candidates" class="candidate-list"></div>
                        </div>
                        <div class="opt-section">
                            <h4>썸네일 텍스트</h4>
                            <div id="thumbnail-texts" class="candidate-list"></div>
                        </div>
                        <div class="opt-section">
                            <h4>해시태그</h4>
                            <div id="hashtags" class="hashtag-list"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             MUSIC VIDEO SECTION
             ══════════════════════════════════════ -->
        <div id="mv-section" class="section hidden">
            <div class="app-form-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="mv.label">만들기</span>
                    <h2 class="section-title" data-i18n="mv.title">뮤직비디오</h2>
                    <p class="section-subtitle" data-i18n="mv.subtitle">Suno, Udio 등의 음악을 업로드하면 AI가 싱크된 뮤직비디오를 자동 제작합니다.</p>
                </div>

                <form id="mv-form" class="app-form">
                    <!-- Upload -->
                    <div class="app-card">
                        <div class="form-group">
                            <label for="mv-music-file" data-i18n="mv.music_file">음악 파일</label>
                            <div class="file-dropzone" id="mv-dropzone">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                                <span class="file-dropzone__text" data-i18n="mv.drop_text">음악 파일을 드래그하거나 클릭해서 선택</span>
                                <span class="file-dropzone__hint" data-i18n="mv.drop_hint">MP3, WAV, M4A, OGG, FLAC (최대 10분)</span>
                                <input type="file" id="mv-music-file" name="music_file"
                                    accept=".mp3,.wav,.m4a,.ogg,.flac" required />
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="mv-lyrics" data-i18n="mv.lyrics_label">가사 (선택)</label>
                            <textarea id="mv-lyrics" name="lyrics" class="form-input form-textarea" rows="5"
                                data-i18n-placeholder="mv.lyrics_placeholder"
                                placeholder="더 정확한 씬 분할을 위해 가사를 입력하세요..."></textarea>
                            <small class="helper-text" data-i18n="mv.lyrics_hint">가사를 입력하면 싱크된 자막이 오버레이됩니다</small>
                        </div>

                        <div class="form-group">
                            <label for="mv-concept" data-i18n="mv.concept_label">비주얼 컨셉 (선택)</label>
                            <input type="text" id="mv-concept" name="concept" class="form-input"
                                data-i18n-placeholder="mv.concept_placeholder"
                                placeholder="예: 달빛 아래 춤추는 요정들, 네온 도시의 거리..." />
                        </div>
                    </div>

                    <!-- Style Settings -->
                    <div class="app-card">
                        <div class="app-card-label" data-i18n="mv.style_settings">스타일 설정</div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label for="mv-character-setup" data-i18n="mv.characters">캐릭터</label>
                                <div class="select-wrapper">
                                    <select id="mv-character-setup" name="character_setup" class="form-select">
                                        <option value="auto" selected>AI 자동</option>
                                        <option value="male_female">남녀 커플</option>
                                        <option value="female_female">여성 커플</option>
                                        <option value="male_male">남성 커플</option>
                                        <option value="solo_male">남성 솔로</option>
                                        <option value="solo_female">여성 솔로</option>
                                        <option value="group">그룹 (3명+)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="mv-character-ethnicity" data-i18n="mv.ethnicity">인종</label>
                                <div class="select-wrapper">
                                    <select id="mv-character-ethnicity" name="character_ethnicity" class="form-select">
                                        <option value="auto" selected>AI 자동</option>
                                        <option value="korean">한국인</option>
                                        <option value="japanese">일본인</option>
                                        <option value="chinese">중국인</option>
                                        <option value="southeast_asian">동남아시아인</option>
                                        <option value="european">유럽인</option>
                                        <option value="black">흑인</option>
                                        <option value="hispanic">히스패닉</option>
                                        <option value="mixed">혼혈</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label for="mv-genre" data-i18n="mv.genre">장르</label>
                                <div class="select-wrapper">
                                    <select id="mv-genre" name="genre" class="form-select">
                                        <option value="fantasy" selected>판타지</option>
                                        <option value="romance">로맨스</option>
                                        <option value="action">액션</option>
                                        <option value="horror">호러</option>
                                        <option value="scifi">SF</option>
                                        <option value="drama">드라마</option>
                                        <option value="comedy">코미디</option>
                                        <option value="abstract">추상</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="mv-mood" data-i18n="mv.mood">분위기</label>
                                <div class="select-wrapper">
                                    <select id="mv-mood" name="mood" class="form-select">
                                        <option value="epic" selected>서사적</option>
                                        <option value="dreamy">몽환적</option>
                                        <option value="energetic">에너제틱</option>
                                        <option value="calm">평온한</option>
                                        <option value="dark">어두운</option>
                                        <option value="romantic">로맨틱</option>
                                        <option value="melancholic">멜랑콜리</option>
                                        <option value="uplifting">고양적</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="mv-style" data-i18n="mv.style">비주얼 스타일</label>
                            <div class="select-wrapper">
                                <select id="mv-style" name="style" class="form-select">
                                    <option value="cinematic" selected>시네마틱</option>
                                    <option value="anime">애니메</option>
                                    <option value="webtoon">웹툰</option>
                                    <option value="realistic">리얼리스틱</option>
                                    <option value="illustration">일러스트</option>
                                    <option value="abstract">추상</option>
                                    <option value="game_anime">게임 애니메</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- MV Options -->
                    <div class="app-card">
                        <div class="app-card-label" data-i18n="mv.options">옵션</div>
                        <div class="toggle-grid">
                            <label class="toggle-item">
                                <input type="checkbox" id="mv-subtitle-enabled" checked>
                                <span class="toggle-switch"></span>
                                <span class="toggle-label">
                                    <span data-i18n="mv_toggle.lyrics">가사 자막</span>
                                    <small data-i18n="mv_toggle.lyrics_desc">영상에 가사 오버레이</small>
                                </span>
                            </label>
                            <label class="toggle-item">
                                <input type="checkbox" id="mv-quick-test">
                                <span class="toggle-switch"></span>
                                <span class="toggle-label">
                                    <span data-i18n="mv_toggle.quick">빠른 테스트 (45초 미리보기)</span>
                                    <small data-i18n="mv_toggle.quick_desc">빠른 미리보기 - 처음 45초만</small>
                                </span>
                            </label>
                            <label class="toggle-item">
                                <input type="checkbox" id="mv-subtitle-only">
                                <span class="toggle-switch"></span>
                                <span class="toggle-label">
                                    <span data-i18n="mv_toggle.sub_only">자막 전용 테스트</span>
                                    <small data-i18n="mv_toggle.sub_only_desc">검정 배경에서 자막 싱크 테스트</small>
                                </span>
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-submit" id="mv-upload-btn">
                        <span data-i18n="mv.generate">뮤직비디오 생성</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                    </button>
                </form>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             MV ANALYSIS SECTION
             ══════════════════════════════════════ -->
        <div id="mv-analysis-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="mva.label">분석</span>
                    <h2 class="section-title" data-i18n="mva.title">음악 분석</h2>
                </div>

                <div class="mv-analysis-info">
                    <div class="mv-stats-grid">
                        <div class="mv-stat-card">
                            <span class="mv-stat-label" data-i18n="mva.duration">길이</span>
                            <span class="mv-stat-value" id="mv-duration">0:00</span>
                        </div>
                        <div class="mv-stat-card">
                            <span class="mv-stat-label">BPM</span>
                            <span class="mv-stat-value" id="mv-bpm">-</span>
                        </div>
                        <div class="mv-stat-card">
                            <span class="mv-stat-label" data-i18n="mva.scenes">씬 수</span>
                            <span class="mv-stat-value" id="mv-suggested-scenes">-</span>
                        </div>
                        <div class="mv-stat-card">
                            <span class="mv-stat-label" data-i18n="mva.mood">분위기</span>
                            <span class="mv-stat-value" id="mv-detected-mood">-</span>
                        </div>
                    </div>
                </div>

                <div class="mv-scene-editor-section">
                    <h3 class="mv-editor-title" data-i18n="mva.editor">씬 에디터</h3>
                    <p class="section-description" data-i18n="mva.editor_desc">
                        자동 분할된 씬을 검토하세요. 설명을 추가하면 더 정확한 비주얼이 생성됩니다.
                    </p>
                    <div id="mv-scene-editor" class="mv-scene-editor-list"></div>
                </div>

                <div class="review-actions review-actions--center">
                    <button id="mv-back-btn" class="btn btn-secondary" data-i18n="mva.reupload">
                        다시 업로드
                    </button>
                    <button id="mv-subtitle-test-btn" class="btn btn-secondary" data-i18n="mva.sub_test">
                        자막 테스트
                    </button>
                    <button id="mv-generate-btn" class="btn btn-primary btn-large" data-i18n="mva.start">
                        MV 생성 시작
                    </button>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             MV PROGRESS SECTION
             ══════════════════════════════════════ -->
        <div id="mv-progress-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <h2 class="section-title" id="mv-progress-title">MV 생성 중...</h2>
                </div>

                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-label">전체 진행률</span>
                        <span class="progress-percentage" id="mv-progress-percentage">0%</span>
                    </div>
                    <div class="progress-bar-wrapper">
                        <div class="progress-bar" id="mv-progress-bar"></div>
                    </div>
                    <div class="status-message" id="mv-status-message">초기화 중...</div>
                    <button id="mv-cancel-btn" class="btn btn-danger btn-small">취소</button>

                    <div class="steps-container" id="mv-steps-container">
                        <div class="step" data-step="analyze">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">음악 분석</div>
                                <div class="step-status">완료</div>
                            </div>
                        </div>
                        <div class="step" data-step="scenes">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">씬 프롬프트</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                        <div class="step" data-step="images">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">이미지 생성</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                        <div class="step" data-step="compose">
                            <div class="step-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
                            </div>
                            <div class="step-content">
                                <div class="step-title">영상 합성</div>
                                <div class="step-status">대기 중</div>
                            </div>
                        </div>
                    </div>

                    <div id="mv-scene-preview" class="mv-scene-preview-area">
                        <h3 class="mv-editor-title">생성된 씬</h3>
                        <div id="mv-scene-grid" class="scene-grid"></div>
                    </div>

                    <div class="log-container">
                        <div class="log-header">
                            <span>실시간 로그</span>
                            <button id="mv-clear-log-btn" class="btn-small">지우기</button>
                        </div>
                        <div class="log-content" id="mv-log-content"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             MV IMAGE REVIEW / EDITOR SECTION
             ══════════════════════════════════════ -->
        <div id="mv-image-review-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="mvr.label">뮤직비디오</span>
                    <h2 class="section-title" id="mv-editor-header">씬 이미지</h2>
                </div>

                <!-- Video area (shown when complete) -->
                <div id="mv-editor-video-area" class="mv-editor-video-area" style="display:none">
                    <div class="result-container">
                        <div class="video-player">
                            <video id="mv-editor-video" controls></video>
                        </div>
                        <div class="result-actions">
                            <a id="mv-editor-download-btn" class="btn btn-primary" download data-i18n="mvr.download">
                                MV 다운로드
                            </a>
                            <label id="mv-editor-music-upload-btn" class="btn btn-secondary" style="display:none">
                                음악 다시 업로드
                                <input type="file" accept=".mp3,.wav,.m4a,.ogg,.flac" class="sr-only"
                                       onchange="app.mvUploadMusicForRecompose(this.files[0])">
                            </label>
                            <button id="mv-editor-recompose-btn" class="btn btn-secondary" style="display:none"
                                    onclick="app.mvRecompose()">
                                영상 재합성
                            </button>
                        </div>
                    </div>
                </div>

                <p id="mv-editor-description" class="section-description" data-i18n="mvr.desc">
                    씬 이미지를 검토하세요. 마음에 들지 않는 씬을 재생성하거나 I2V 영상 클립으로 변환할 수 있습니다.
                </p>
                <div id="mv-image-review-grid" class="result-scene-grid"></div>
                <div id="mv-editor-bottom-actions" class="review-actions review-actions--center">
                    <button id="mv-compose-btn" class="btn btn-primary btn-large" data-i18n="mvr.compose">
                        최종 MV 생성
                    </button>
                    <button class="btn btn-secondary" onclick="app.resetMVUI()" data-i18n="mvr.new_mv">
                        새 뮤직비디오
                    </button>
                </div>

                <!-- Lyrics Timeline Editor Modal -->
                <div id="lyrics-timeline-overlay" class="lyrics-timeline-overlay">
                    <div class="lyrics-timeline-modal">
                        <div class="lyrics-timeline-header">
                            <h3>가사 타임라인 편집</h3>
                            <button class="lyrics-timeline-close" onclick="app.closeLyricsTimeline()">&times;</button>
                        </div>
                        <div class="lyrics-timeline-body">
                            <table class="lyrics-timeline-table">
                                <thead>
                                    <tr>
                                        <th class="col-time">시간</th>
                                        <th class="col-stt">STT</th>
                                        <th class="col-lyrics">자막 텍스트</th>
                                        <th class="col-del"></th>
                                    </tr>
                                </thead>
                                <tbody id="lyrics-timeline-tbody"></tbody>
                            </table>
                        </div>
                        <div class="lyrics-timeline-footer">
                            <div class="footer-left">
                                <button class="btn-tl-add" onclick="app.timelineAddRow()">+ 행 추가</button>
                            </div>
                            <div class="footer-right">
                                <button class="btn-tl-reset" onclick="app.timelineReset()">초기화</button>
                                <button id="btn-tl-save" class="btn-tl-save" onclick="app.timelineSave()">저장</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ══════════════════════════════════════
             HISTORY SECTION
             ══════════════════════════════════════ -->
        <div id="history-section" class="section hidden">
            <div class="app-wide-container">
                <div class="app-section-header">
                    <span class="section-label" data-i18n="history.label">라이브러리</span>
                    <h2 class="section-title" data-i18n="history.title">내 영상</h2>
                </div>

                <div class="history-container">
                    <div class="retention-notice" data-i18n="history.retention">
                        이미지는 다음 날 오전 3시에 자동 삭제됩니다. 최종 영상은 3일 후 삭제됩니다.
                        중요한 영상은 미리 다운로드해 주세요.
                    </div>
                    <div class="history-toolbar">
                        <div class="history-filter-tabs">
                            <button class="history-filter-btn active" data-filter="all">전체</button>
                            <button class="history-filter-btn" data-filter="video">영상</button>
                            <button class="history-filter-btn" data-filter="mv">MV</button>
                        </div>
                        <button id="refresh-history-btn" class="btn btn-secondary btn-small" data-i18n="history.refresh">
                            새로고침
                        </button>
                    </div>
                    <div id="history-grid" class="history-grid"></div>
                </div>
            </div>
        </div>

    </main>

    <!-- Profile Modal -->
    <div id="profile-modal" class="modal-overlay" onclick="if(event.target===this)closeProfileModal()">
        <div class="modal-card profile-modal-card">
            <button class="modal-close" onclick="closeProfileModal()">&times;</button>

            <!-- Common Header -->
            <div class="profile-header">
                <div class="profile-avatar">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </div>
                <div class="profile-header-info">
                    <div class="profile-name-row">
                        <h3 class="profile-name" id="profile-name">User</h3>
                        <button class="profile-edit-name-btn" onclick="toggleUsernameEdit()" title="이름 편집">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                        </button>
                    </div>
                    <div class="profile-name-edit" id="profile-name-edit" style="display:none">
                        <input type="text" id="profile-name-input" class="form-input profile-name-input" />
                        <button class="profile-name-save" onclick="updateUsername()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                        </button>
                        <button class="profile-name-cancel" onclick="toggleUsernameEdit()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                        </button>
                    </div>
                    <p class="profile-email" id="profile-email">user@example.com</p>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="profile-tabs">
                <button class="profile-tab active" data-tab="account" onclick="switchProfileTab('account')">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    <span>계정</span>
                </button>
                <button class="profile-tab" data-tab="clips" onclick="switchProfileTab('clips')">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><text x="12" y="16" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor">C</text></svg>
                    <span>클립</span>
                </button>
                <button class="profile-tab" data-tab="stats" onclick="switchProfileTab('stats')">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10M12 20V4M6 20v-6"/></svg>
                    <span>통계</span>
                </button>
                <button class="profile-tab" data-tab="settings" onclick="switchProfileTab('settings')">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
                    <span>설정</span>
                </button>
            </div>

            <!-- Tab Content -->
            <div class="profile-tab-content">

                <!-- Account Tab -->
                <div id="profile-tab-account" class="profile-tab-panel active">
                    <div class="profile-account-info">
                        <div class="profile-info-row">
                            <span class="profile-info-label">이메일</span>
                            <span class="profile-info-value" id="profile-account-email">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Google</span>
                            <span class="profile-info-value" id="profile-google-status">
                                <span class="profile-badge profile-badge-connected">연결됨</span>
                            </span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">플랜</span>
                            <span class="profile-info-value" id="profile-plan">Free</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">가입일</span>
                            <span class="profile-info-value" id="profile-since">N/A</span>
                        </div>
                    </div>
                    <div class="profile-actions" style="margin-top: var(--space-6)">
                        <button onclick="logout()" class="btn-profile btn-profile-danger" style="flex:none; width:100%">로그아웃</button>
                    </div>
                </div>

                <!-- Clips Tab -->
                <div id="profile-tab-clips" class="profile-tab-panel">
                    <div class="profile-clips-hero">
                        <span class="profile-clips-big" id="profile-clips">0</span>
                        <span class="profile-clips-label">남은 클립</span>
                    </div>
                    <div class="profile-clips-plan-row">
                        <span>현재 플랜: <strong id="profile-clips-plan">Free</strong></span>
                        <a href="/pricing.html" class="btn-profile-sm btn-profile-primary">업그레이드</a>
                    </div>
                    <div class="profile-clips-history">
                        <h4 class="profile-section-title">사용 내역</h4>
                        <div id="profile-history-list" class="profile-history-list">
                            <p class="profile-empty-state">아직 클립 사용 내역이 없습니다.</p>
                        </div>
                    </div>
                    <a href="/pricing.html" class="btn-profile btn-profile-primary" style="width:100%; margin-top:var(--space-4)">클립 충전하기</a>
                </div>

                <!-- Stats Tab -->
                <div id="profile-tab-stats" class="profile-tab-panel">
                    <div class="profile-stats-grid">
                        <div class="profile-stat-card">
                            <span class="profile-stat-value" id="profile-stat-videos">-</span>
                            <span class="profile-stat-label">스토리 영상</span>
                        </div>
                        <div class="profile-stat-card">
                            <span class="profile-stat-value" id="profile-stat-mvs">-</span>
                            <span class="profile-stat-label">뮤직비디오</span>
                        </div>
                        <div class="profile-stat-card">
                            <span class="profile-stat-value" id="profile-stat-clips-used">-</span>
                            <span class="profile-stat-label">사용한 클립</span>
                        </div>
                        <div class="profile-stat-card">
                            <span class="profile-stat-value" id="profile-stat-since">-</span>
                            <span class="profile-stat-label">가입일</span>
                        </div>
                    </div>
                    <div class="profile-stats-extra" id="profile-stats-extra" style="display:none">
                        <div class="profile-info-row">
                            <span class="profile-info-label">선호 스타일</span>
                            <span class="profile-info-value" id="profile-stat-top-style">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">선호 장르</span>
                            <span class="profile-info-value" id="profile-stat-top-genre">-</span>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="profile-tab-settings" class="profile-tab-panel">
                    <div class="profile-settings-form">
                        <div class="profile-setting-group">
                            <label class="profile-setting-label">기본 스타일</label>
                            <div class="select-wrapper">
                                <select id="pref-style" class="form-select" onchange="savePreferences()">
                                    <option value="">없음 (폼 기본값 사용)</option>
                                    <option value="cinematic, high contrast">시네마틱</option>
                                    <option value="realistic">리얼리스틱</option>
                                    <option value="illustration">일러스트</option>
                                    <option value="anime">애니메</option>
                                    <option value="webtoon">웹툰</option>
                                    <option value="game_anime">게임 애니메</option>
                                </select>
                            </div>
                        </div>
                        <div class="profile-setting-group">
                            <label class="profile-setting-label">기본 장르</label>
                            <div class="select-wrapper">
                                <select id="pref-genre" class="form-select" onchange="savePreferences()">
                                    <option value="">없음 (폼 기본값 사용)</option>
                                    <option value="emotional">감성</option>
                                    <option value="mystery">미스터리</option>
                                    <option value="thriller">스릴러</option>
                                    <option value="fantasy">판타지</option>
                                    <option value="horror">호러</option>
                                    <option value="comedy">코미디</option>
                                </select>
                            </div>
                        </div>
                        <div class="profile-setting-group">
                            <label class="profile-setting-label">기본 언어</label>
                            <div class="select-wrapper">
                                <select id="pref-language" class="form-select" onchange="savePreferences()">
                                    <option value="">없음 (자동)</option>
                                    <option value="ko">한국어</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>
                        <p class="profile-setting-hint">새 영상 생성 시 이 기본값이 자동 적용됩니다.</p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <p>&copy; 2026 Klippa | AI 영상 제작 스튜디오</p>
        <p><a href="/privacy.html">개인정보처리방침</a> | <a href="/terms.html">이용약관</a> | <a href="/docs" target="_blank">API 문서</a></p>
    </footer>

    <script src="/static/app.js?v=20260218_0100"></script>
    <script>
    // ─── App i18n (synced with landing page via localStorage) ───
    (function() {
      const T = {
        ko: {
          // Nav
          'nav.create': '새 영상', 'nav.mv': '뮤직비디오', 'nav.history': '내 영상',
          'nav.pricing': '요금제',
          // Input section
          'input.label': '만들기', 'input.title': '새 영상',
          'input.subtitle': '주제를 입력하면 AI가 내레이션, 이미지, 효과가 포함된 영상을 자동 생성합니다.',
          'input.mode_ai': 'AI 스토리', 'input.mode_script': '직접 입력',
          'input.topic_label': '주제 / 아이디어',
          'input.topic_placeholder': '예: 오래된 폐병원에서 발견된 미스터리 일기장',
          'input.topic_hint': '비워두면 AI가 자동으로 주제를 생성합니다',
          'input.script_label': '내레이션 스크립트',
          'input.script_placeholder': '내레이션 스크립트를 붙여넣으세요.\n\n빈 줄로 씬을 구분합니다.\n\n예시:\n망해가는 상가 속 번창하는 가게.\n비즈니스 랩에 오신 걸 환영합니다.\n\n지난번 소개한 매장은\n엄청난 반응을 얻었습니다.',
          'input.script_hint': '빈 줄로 씬을 구분하세요. AI가 각 씬에 맞는 이미지를 생성합니다.',
          'input.style_genre': '스타일 & 장르',
          'input.genre': '장르', 'input.mood': '분위기',
          'input.style': '비주얼 스타일', 'input.ethnicity': '캐릭터 인종',
          'input.voice_duration': '음성 & 길이',
          'input.voice': '음성 (TTS)', 'input.sample': '미리듣기',
          'input.platform': '플랫폼',
          'input.advanced': '고급 설정', 'input.image_model': '이미지 모델',
          'input.generate': '스토리 생성',
          // Review
          'review.label': '2단계', 'review.title': '스토리 검토',
          'review.subtitle': 'AI가 생성한 스토리를 검토하세요. 내레이션이나 비주얼 설명을 자유롭게 편집한 뒤 이미지 생성으로 진행하세요.',
          'review.back': '설정으로 돌아가기',
          'review.gen_images': '이미지 생성 (2단계)',
          'review.skip_video': '영상으로 건너뛰기',
          // Image preview
          'image.label': '3단계', 'image.title': '이미지 검토',
          'image.subtitle': '각 씬의 이미지를 검토하세요. 재생성하거나 I2V 영상으로 변환할 수 있습니다.',
          'image.edit_story': '스토리 편집',
          'image.test': '테스트 이미지',
          'image.approve': '승인 & 영상 생성 (3단계)',
          // Result
          'result.label': '완료', 'result.title': '영상 완성!',
          'result.download': '영상 다운로드', 'result.new_video': '새 영상',
          'result.scene_mgmt': '씬 관리',
          'result.scene_desc': '개별 씬을 검토하고 필요한 것을 재생성하세요. 변경 후 "영상 재합성"을 클릭하면 최종 영상이 업데이트됩니다.',
          'result.recompose': '영상 재합성',
          // MV
          'mv.label': '만들기', 'mv.title': '뮤직비디오',
          'mv.subtitle': 'Suno, Udio 등의 음악을 업로드하면 AI가 싱크된 뮤직비디오를 자동 제작합니다.',
          'mv.music_file': '음악 파일',
          'mv.drop_text': '음악 파일을 드래그하거나 클릭해서 선택',
          'mv.drop_hint': 'MP3, WAV, M4A, OGG, FLAC (최대 10분)',
          'mv.lyrics_label': '가사 (선택)',
          'mv.lyrics_placeholder': '더 정확한 씬 분할을 위해 가사를 입력하세요...',
          'mv.lyrics_hint': '가사를 입력하면 싱크된 자막이 오버레이됩니다',
          'mv.concept_label': '비주얼 컨셉 (선택)',
          'mv.concept_placeholder': '예: 달빛 아래 춤추는 요정들, 네온 도시의 거리...',
          'mv.style_settings': '스타일 설정',
          'mv.characters': '캐릭터', 'mv.ethnicity': '인종',
          'mv.genre': '장르', 'mv.mood': '분위기', 'mv.style': '비주얼 스타일',
          'mv.options': '옵션',
          'mv.generate': '뮤직비디오 생성',
          // MV toggles
          'mv_toggle.lyrics': '가사 자막', 'mv_toggle.lyrics_desc': '영상에 가사 오버레이',
          'mv_toggle.quick': '빠른 테스트 (45초 미리보기)', 'mv_toggle.quick_desc': '빠른 미리보기 - 처음 45초만',
          'mv_toggle.sub_only': '자막 전용 테스트', 'mv_toggle.sub_only_desc': '검정 배경에서 자막 싱크 테스트',
          // Advanced toggles
          'toggle.kenburns': 'Ken Burns 효과', 'toggle.kenburns_desc': '이미지에 줌 & 패닝',
          'toggle.ducking': '오디오 덕킹', 'toggle.ducking_desc': '내레이션 시 BGM 자동 줄임',
          'toggle.subtitles': '자막', 'toggle.subtitles_desc': '영상에 자막 삽입',
          'toggle.context': '맥락 이어가기', 'toggle.context_desc': '씬 간 일관성 유지',
          'toggle.optimize': '최적화 패키지', 'toggle.optimize_desc': '제목, 썸네일, 해시태그 자동 생성',
          // MV Analysis
          'mva.label': '분석', 'mva.title': '음악 분석',
          'mva.duration': '길이', 'mva.scenes': '씬 수', 'mva.mood': '분위기',
          'mva.editor': '씬 에디터', 'mva.editor_desc': '자동 분할된 씬을 검토하세요. 설명을 추가하면 더 정확한 비주얼이 생성됩니다.',
          'mva.reupload': '다시 업로드', 'mva.sub_test': '자막 테스트', 'mva.start': 'MV 생성 시작',
          // MV Review
          'mvr.label': '뮤직비디오',
          'mvr.download': 'MV 다운로드', 'mvr.desc': '씬 이미지를 검토하세요. 마음에 들지 않는 씬은 재생성하거나 I2V 영상 클립으로 변환할 수 있습니다.',
          'mvr.compose': '최종 MV 생성', 'mvr.new_mv': '새 뮤직비디오',
          // History
          'history.label': '라이브러리', 'history.title': '내 영상',
          'history.retention': '이미지는 다음날 새벽 3시에 자동 삭제됩니다. 최종 영상은 3일 후 삭제됩니다. 중요한 영상은 미리 다운로드하세요.',
          'history.refresh': '새로고침',
        },
        en: {}  // English is the HTML default, no overrides needed
      };

      function applyLang(lang) {
        const dict = T[lang] || {};
        if (lang === 'en') return; // HTML already in English
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (dict[key]) el.textContent = dict[key];
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
          const key = el.getAttribute('data-i18n-placeholder');
          if (dict[key]) el.placeholder = dict[key];
        });
      }

      const lang = localStorage.getItem('klippa_lang') || 'ko';
      if (lang !== 'en') applyLang(lang);
    })();
    </script>
</body>

</html>